<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="description" content="Professional Hot Tub Maintenance & Compliance Documentation System">
    <meta name="author" content="Omnibosh">
    <title>Hot Tub Maintenance & Compliance System</title>
    <style>
        :root {
            --primary-orange: #FF6B35;
            --dark-orange: #E55100;
            --light-orange: #FFA500;
            --black: #000000;
            --dark-gray: #1a1a1a;
            --white: #FFFFFF;
            --light-gray: #f5f5f5;
            --border-gray: #ddd;
            --shadow-color: rgba(0, 0, 0, 0.3);
            --shadow-hover: rgba(0, 0, 0, 0.5);
            --success-green: #28a745;
            --error-red: #dc3545;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background: var(--white);
            color: var(--black);
            line-height: 1.6;
            min-height: 100vh;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            touch-action: manipulation;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 15px;
            padding-bottom: 100px;
        }

        /* Form Styles */
        .maintenance-form {
            width: 100%;
        }

        /* SWP Floating Button */
        .swp-button {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 60px;
            height: 60px;
            background: linear-gradient(145deg, var(--primary-orange), var(--dark-orange));
            border: 3px solid var(--black);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 
                0 5px 15px rgba(0, 0, 0, 0.4),
                inset 1px 1px 2px rgba(255, 255, 255, 0.3);
            z-index: 1000;
            transition: all 0.3s ease;
            font-size: 18px;
            color: var(--white);
            font-weight: bold;
        }

        .swp-button:hover {
            transform: scale(1.1);
            box-shadow: 
                0 7px 20px rgba(0, 0, 0, 0.5),
                inset 1px 1px 2px rgba(255, 255, 255, 0.4);
        }

        .swp-tooltip {
            position: absolute;
            bottom: 70px;
            right: 0;
            background: var(--black);
            color: var(--white);
            padding: 8px 12px;
            border-radius: 8px;
            font-size: 12px;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }

        .swp-button:hover .swp-tooltip {
            opacity: 1;
        }

        .header {
            background: linear-gradient(135deg, var(--black) 0%, var(--dark-gray) 100%);
            color: var(--white);
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 20px;
            box-shadow: 0 8px 20px var(--shadow-color);
            border: 3px solid var(--primary-orange);
        }

        .header h1 {
            font-size: clamp(1.5rem, 5vw, 2.5rem);
            font-weight: 700;
            margin-bottom: 10px;
            color: var(--primary-orange);
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }

        .header-subtitle {
            font-size: clamp(0.9rem, 2vw, 1.1rem);
            opacity: 0.9;
            margin-bottom: 20px;
            color: var(--white);
        }

        .header-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .section {
            background: var(--white);
            padding: clamp(15px, 3vw, 30px);
            margin-bottom: 20px;
            border-radius: 15px;
            box-shadow: 0 5px 15px var(--shadow-color);
            border: 2px solid var(--black);
            position: relative;
        }

        .section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 5px;
            background: linear-gradient(90deg, var(--primary-orange), var(--dark-orange));
            border-radius: 15px 15px 0 0;
        }

        .section h2 {
            color: var(--black);
            margin-bottom: 20px;
            font-size: clamp(1.3rem, 3vw, 1.8rem);
            font-weight: 700;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
        }

        .section h3 {
            color: var(--primary-orange);
            margin-bottom: 15px;
            font-size: clamp(1.1rem, 2.5vw, 1.4rem);
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--black);
            font-size: clamp(0.85rem, 1.5vw, 0.95rem);
        }

        input, select, textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid var(--black);
            border-radius: 8px;
            font-size: 16px;
            font-family: inherit;
            transition: all 0.3s ease;
            background: var(--white);
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
        }

        input[type="number"] {
            font-size: clamp(16px, 3vw, 20px);
            font-weight: bold;
            padding: 15px;
        }

        input[type="date"] {
            min-height: 44px;
        }

        select {
            background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");
            background-repeat: no-repeat;
            background-position: right 10px center;
            background-size: 20px;
            padding-right: 40px;
        }

        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: var(--primary-orange);
            box-shadow: 0 0 0 3px rgba(255, 107, 53, 0.2);
        }

        .btn {
            background: linear-gradient(145deg, var(--primary-orange), var(--dark-orange));
            color: var(--white);
            padding: clamp(12px, 2vw, 14px) clamp(20px, 3vw, 28px);
            border: 2px solid var(--black);
            border-radius: 10px;
            font-size: clamp(14px, 2vw, 16px);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 6px 4px;
            box-shadow: 
                5px 5px 10px rgba(0, 0, 0, 0.3),
                inset 1px 1px 2px rgba(255, 255, 255, 0.3);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            position: relative;
            display: inline-block;
            min-height: 44px;
            white-space: nowrap;
        }

        .btn:hover, .btn:focus {
            transform: translateY(-2px);
            box-shadow: 
                7px 7px 15px rgba(0, 0, 0, 0.4),
                inset 1px 1px 2px rgba(255, 255, 255, 0.4);
            background: linear-gradient(145deg, var(--dark-orange), var(--primary-orange));
        }

        .btn:active {
            transform: translateY(0);
            box-shadow: 
                3px 3px 6px rgba(0, 0, 0, 0.3),
                inset 1px 1px 2px rgba(255, 255, 255, 0.2);
        }

        .btn-success {
            background: linear-gradient(145deg, #28a745, #218838);
        }

        .btn-success:hover {
            background: linear-gradient(145deg, #218838, #28a745);
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none !important;
        }

        .btn-container {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
            margin: 20px 0;
        }

        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .checklist {
            display: grid;
            gap: 10px;
        }

        .checklist-item {
            display: flex;
            align-items: center;
            padding: clamp(12px, 2vw, 16px);
            background: var(--light-gray);
            border-radius: 10px;
            border: 2px solid var(--black);
            transition: all 0.3s ease;
            cursor: pointer;
            min-height: 50px;
        }

        .checklist-item:hover, .checklist-item:focus-within {
            background: var(--light-orange);
            transform: translateX(5px);
            box-shadow: 3px 3px 8px var(--shadow-color);
        }

        .checklist-item input[type="checkbox"] {
            width: 24px;
            height: 24px;
            margin-right: 12px;
            cursor: pointer;
            accent-color: var(--primary-orange);
            flex-shrink: 0;
        }

        .checklist-item label {
            margin: 0;
            cursor: pointer;
            font-weight: 500;
            font-size: clamp(0.9rem, 1.8vw, 1rem);
        }

        .water-quality {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .quality-item {
            text-align: center;
            padding: clamp(15px, 2vw, 25px);
            background: var(--light-gray);
            border-radius: 12px;
            border: 2px solid var(--black);
            transition: all 0.3s ease;
            box-shadow: 3px 3px 8px var(--shadow-color);
        }

        .quality-item:hover, .quality-item:focus-within {
            transform: translateY(-4px);
            box-shadow: 5px 5px 12px var(--shadow-color);
            background: var(--light-orange);
        }

        .quality-item input {
            font-size: clamp(1.3rem, 3vw, 1.8rem);
            font-weight: 700;
            text-align: center;
            border: 3px solid var(--black);
            background: var(--white);
            margin: 10px 0;
            padding: 10px;
        }

        .quality-range {
            font-size: clamp(0.75rem, 1.5vw, 0.85rem);
            color: var(--dark-gray);
            font-weight: 600;
        }

        .hottub-manager-section {
            background: linear-gradient(135deg, var(--light-gray), var(--white));
            border: 3px solid var(--primary-orange);
            border-radius: 12px;
            padding: clamp(15px, 2vw, 25px);
            margin-top: 20px;
            box-shadow: 0 5px 15px var(--shadow-color);
        }

        .maintenance-tasks-section {
            margin-top: 30px;
            padding: 25px;
            background: linear-gradient(135deg, var(--light-gray), var(--white));
            border: 3px solid var(--primary-orange);
            border-radius: 12px;
            box-shadow: 0 5px 15px var(--shadow-color);
        }

        .complete-all-section {
            background: linear-gradient(135deg, var(--primary-orange), var(--dark-orange));
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            border: 2px solid var(--black);
            box-shadow: 3px 3px 10px var(--shadow-color);
        }

        .complete-all-section h4 {
            color: var(--white);
            margin-bottom: 15px;
        }

        .chemical-input-box {
            background: var(--light-gray);
            border: 2px solid var(--primary-orange);
            border-radius: 10px;
            padding: 15px;
            margin: 10px 0;
            box-shadow: 3px 3px 8px var(--shadow-color);
        }

        .chemical-input-box h4 {
            color: var(--primary-orange);
            margin-bottom: 10px;
            font-size: clamp(1rem, 2vw, 1.1rem);
        }

        .number-pad {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
            margin-top: 10px;
            max-width: 400px;
            margin-left: auto;
            margin-right: auto;
        }

        .number-pad button {
            padding: clamp(15px, 3vw, 20px);
            font-size: clamp(18px, 3vw, 24px);
            font-weight: bold;
            background: linear-gradient(145deg, var(--light-gray), var(--white));
            border: 2px solid var(--black);
            border-radius: 10px;
            cursor: pointer;
            box-shadow: 3px 3px 6px var(--shadow-color);
            transition: all 0.2s ease;
            min-height: 50px;
            touch-action: manipulation;
        }

        .number-pad button:hover, .number-pad button:focus {
            background: linear-gradient(145deg, var(--primary-orange), var(--dark-orange));
            color: var(--white);
            transform: scale(1.05);
        }

        .number-pad button:active {
            transform: scale(0.95);
        }

        .emergency-contact {
            background: linear-gradient(135deg, var(--black), var(--dark-gray));
            color: var(--white);
            padding: clamp(20px, 3vw, 25px);
            border-radius: 15px;
            margin-top: 30px;
            text-align: center;
            box-shadow: 0 5px 15px var(--shadow-color);
            border: 3px solid var(--primary-orange);
        }

        .emergency-contact h3 {
            color: var(--primary-orange);
            margin-bottom: 15px;
            font-size: clamp(1.2rem, 2.5vw, 1.5rem);
        }

        .emergency-contact p {
            font-size: clamp(0.85rem, 1.5vw, 1rem);
            line-height: 1.8;
        }

        /* Loading and feedback styles */
        .loading {
            display: none;
            text-align: center;
            padding: 20px;
        }

        .loading.show {
            display: block;
        }

        .success-message {
            background: var(--success-green);
            color: white;
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
            display: none;
        }

        .error-message {
            background: var(--error-red);
            color: white;
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
            display: none;
        }

        .success-message.show,
        .error-message.show {
            display: block;
        }

        /* Hidden form fields for Formspree */
        .hidden-fields {
            display: none;
        }

        /* Mobile Specific Styles */
        @media (max-width: 767px) {
            .container {
                padding: 10px;
                padding-bottom: 100px;
            }

            .header {
                padding: 20px 15px;
            }

            .section {
                padding: 15px;
                margin-bottom: 15px;
            }

            .form-row {
                grid-template-columns: 1fr;
                gap: 12px;
            }

            .water-quality {
                grid-template-columns: 1fr;
                gap: 12px;
            }

            .btn-container {
                flex-direction: column;
                align-items: stretch;
            }

            .btn {
                width: 100%;
                margin: 5px 0;
            }

            .number-pad {
                max-width: 100%;
            }
        }

        /* Accessibility */
        *:focus-visible {
            outline: 3px solid var(--primary-orange);
            outline-offset: 2px;
        }

        /* Smooth scrolling */
        html {
            scroll-behavior: smooth;
        }

        /* Print styles */
        @media print {
            .swp-button, .btn-container {
                display: none;
            }
            
            .section {
                break-inside: avoid;
                page-break-inside: avoid;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- REPLACE 'your-form-id' with your actual Formspree form ID -->
        <form class="maintenance-form" action="https://formspree.io/f/your-form-id" method="POST" enctype="multipart/form-data" id="maintenanceForm">
            
            <!-- Hidden fields for better email organization -->
            <input type="hidden" name="_subject" value="Hot Tub Maintenance Report">
            <input type="hidden" name="_template" value="table">
            <input type="hidden" name="_next" value="#success">
            
            <div class="header">
                <h1>Hot Tub Maintenance & Compliance</h1>
                <div class="header-subtitle">Professional Maintenance Documentation System</div>
                <div class="header-info">
                    <div>
                        <label for="business-name">Business Name:*</label>
                        <input type="text" id="business-name" name="business_name" placeholder="Holiday Park / Hotel Name" required autocomplete="organization">
                    </div>
                    <div>
                        <label for="maintenance-date">Maintenance Date:*</label>
                        <input type="date" id="maintenance-date" name="maintenance_date" required>
                    </div>
                    <div>
                        <label for="technician">Technician Name:*</label>
                        <input type="text" id="technician" name="technician_name" placeholder="Qualified Technician Name" required autocomplete="name">
                    </div>
                    <div>
                        <label for="licence-number">License/Cert Number:</label>
                        <input type="text" id="licence-number" name="license_number" placeholder="Professional Certification">
                    </div>
                </div>
            </div>

            <div class="section">
                <h2>Equipment Selection & Management</h2>
                
                <div class="form-row">
                    <div>
                        <label for="hottub-id">Hot Tub ID/Location:*</label>
                        <select id="hottub-id" name="hottub_id" required onchange="updateHotTubSpecs()">
                            <option value="">Select Hot Tub</option>
                            <option value="HT-001">HT-001 - Pool Deck</option>
                            <option value="HT-002">HT-002 - Cabin Area</option>
                            <option value="HT-003">HT-003 - Spa Complex</option>
                            <option value="HT-004">HT-004 - Lodge Terrace</option>
                            <option value="HT-005">HT-005 - Beach House</option>
                        </select>
                    </div>
                    <div>
                        <label for="hottub-capacity">Capacity (Litres):</label>
                        <input type="number" id="hottub-capacity" name="hottub_capacity" placeholder="Auto-filled when selected" readonly>
                    </div>
                    <div>
                        <label for="last-service">Last Professional Service:</label>
                        <input type="date" id="last-service" name="last_service">
                    </div>
                </div>

                <div class="hottub-manager-section">
                    <h3>Hot Tub Information</h3>
                    <div id="selected-hottub-info" style="display: none; padding: 20px; background: white; border: 2px solid var(--primary-orange); border-radius: 12px; margin-top: 20px;">
                        <h4 style="color: var(--primary-orange); margin-bottom: 15px;">Currently Selected Hot Tub</h4>
                        <div id="selected-hottub-details"></div>
                    </div>
                </div>

                <div class="maintenance-tasks-section">
                    <h3 style="color: var(--primary-orange); margin-bottom: 20px;">Maintenance Type & Tasks</h3>
                    
                    <div class="form-group">
                        <label for="maintenance-type">Select Maintenance Type:*</label>
                        <select id="maintenance-type" name="maintenance_type" required onchange="showMaintenanceTasks()">
                            <option value="">Select Maintenance Type</option>
                            <option value="daily">Daily Check</option>
                            <option value="changeover">Changeover Maintenance</option>
                        </select>
                    </div>

                    <div id="daily-tasks" style="display: none;">
                        <h4 style="color: var(--primary-orange); margin-bottom: 15px;">Daily Check Tasks</h4>
                        
                        <div class="complete-all-section">
                            <h4>Quick Complete - All Tasks</h4>
                            <button type="button" class="btn btn-success" onclick="completeAllDailyTasks()">
                                ✅ COMPLETE ALL DAILY TASKS
                            </button>
                            <p style="color: var(--white); margin-top: 10px; font-size: 0.9rem;">
                                This will mark all daily tasks as completed
                            </p>
                        </div>

                        <div class="checklist">
                            <div class="checklist-item">
                                <input type="checkbox" id="visual-inspection" name="daily_tasks" value="visual-inspection">
                                <label for="visual-inspection">Visual inspection of water clarity and equipment</label>
                            </div>
                            <div class="checklist-item">
                                <input type="checkbox" id="water-testing" name="daily_tasks" value="water-testing">
                                <label for="water-testing">Water chemistry testing completed and logged</label>
                            </div>
                            <div class="checklist-item">
                                <input type="checkbox" id="waterline-clean" name="daily_tasks" value="waterline-clean">
                                <label for="waterline-clean">Waterline cleaned and scrubbed</label>
                            </div>
                            <div class="checklist-item">
                                <input type="checkbox" id="surface-debris" name="daily_tasks" value="surface-debris">
                                <label for="surface-debris">Surface debris removed</label>
                            </div>
                            <div class="checklist-item">
                                <input type="checkbox" id="lid-inspection" name="daily_tasks" value="lid-inspection">
                                <label for="lid-inspection">Hot tub lid/cover inspected for damage</label>
                            </div>
                            <div class="checklist-item">
                                <input type="checkbox" id="lid-clean" name="daily_tasks" value="lid-clean">
                                <label for="lid-clean">Hot tub lid cleaned and treated</label>
                            </div>
                            <div class="checklist-item">
                                <input type="checkbox" id="lid-secure" name="daily_tasks" value="lid-secure">
                                <label for="lid-secure">Hot tub lid properly secured and locked</label>
                            </div>
                            <div class="checklist-item">
                                <input type="checkbox" id="safety-equipment" name="daily_tasks" value="safety-equipment">
                                <label for="safety-equipment">Safety equipment check (emergency stop, signage)</label>
                            </div>
                        </div>
                    </div>

                    <div id="changeover-tasks" style="display: none;">
                        <h4 style="color: var(--primary-orange); margin-bottom: 15px;">Changeover Maintenance Tasks</h4>
                        <div class="checklist">
                            <div class="checklist-item">
                                <input type="checkbox" id="full-drain" name="changeover_tasks" value="full-drain">
                                <label for="full-drain">Complete hot tub drain</label>
                            </div>
                            <div class="checklist-item">
                                <input type="checkbox" id="shell-clean" name="changeover_tasks" value="shell-clean">
                                <label for="shell-clean">Full shell and surface cleaning</label>
                            </div>
                            <div class="checklist-item">
                                <input type="checkbox" id="jet-deep-clean" name="changeover_tasks" value="jet-deep-clean">
                                <label for="jet-deep-clean">Jets deep cleaned and inspected</label>
                            </div>
                            <div class="checklist-item">
                                <input type="checkbox" id="filter-change" name="changeover_tasks" value="filter-change">
                                <label for="filter-change">Filter cartridges changed</label>
                            </div>
                            <div class="checklist-item">
                                <input type="checkbox" id="lid-deep-clean" name="changeover_tasks" value="lid-deep-clean">
                                <label for="lid-deep-clean">Hot tub lid deep cleaned and conditioned</label>
                            </div>
                            <div class="checklist-item">
                                <input type="checkbox" id="lid-hinges" name="changeover_tasks" value="lid-hinges">
                                <label for="lid-hinges">Lid hinges and locks serviced</label>
                            </div>
                            <div class="checklist-item">
                                <input type="checkbox" id="refill-complete" name="changeover_tasks" value="refill-complete">
                                <label for="refill-complete">Complete refill and initial chemical balance</label>
                            </div>
                            <div class="checklist-item">
                                <input type="checkbox" id="system-restart" name="changeover_tasks" value="system-restart">
                                <label for="system-restart">System restart and circulation check</label>
                            </div>
                            <div class="checklist-item">
                                <input type="checkbox" id="final-testing" name="changeover_tasks" value="final-testing">
                                <label for="final-testing">Final water quality testing and adjustment</label>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="section">
                <h2>Water Quality Testing & Monitoring</h2>
                <div class="water-quality">
                    <div class="quality-item">
                        <label for="ph-level">pH Level</label>
                        <input type="number" id="ph-level" name="ph_level" step="0.1" min="6.0" max="8.0" inputmode="decimal">
                        <div class="quality-range">Target: 7.2 - 7.6</div>
                    </div>
                    <div class="quality-item">
                        <label for="bromine-level">Free Bromine (mg/l)</label>
                        <input type="number" id="bromine-level" name="bromine_level" step="0.1" min="0" max="8" inputmode="decimal">
                        <div class="quality-range">Target: 3.0 - 5.0 mg/l</div>
                    </div>
                    <div class="quality-item">
                        <label for="temperature">Temperature (°C)</label>
                        <input type="number" id="temperature" name="temperature" step="0.1" min="35" max="40" inputmode="decimal">
                        <div class="quality-range">Legal Max: 40°C</div>
                    </div>
                    <div class="quality-item">
                        <label for="total-alkalinity">Total Alkalinity</label>
                        <input type="number" id="total-alkalinity" name="total_alkalinity" step="1" min="80" max="200" inputmode="numeric">
                        <div class="quality-range">Target: 80 - 120 mg/l</div>
                    </div>
                </div>
            </div>

            <div class="section">
                <h2>Chemical Treatment Log</h2>
                <div class="form-group">
                    <label for="chemicals-used">Chemicals Used (select all that apply):</label>
                    <div class="checklist">
                        <div class="checklist-item">
                            <input type="checkbox" id="chem-bromine" name="chemicals_used" value="bromine">
                            <label for="chem-bromine">Bromine Tablets</label>
                        </div>
                        <div class="checklist-item">
                            <input type="checkbox" id="chem-ph-plus" name="chemicals_used" value="ph-plus">
                            <label for="chem-ph-plus">pH Plus</label>
                        </div>
                        <div class="checklist-item">
                            <input type="checkbox" id="chem-ph-minus" name="chemicals_used" value="ph-minus">
                            <label for="chem-ph-minus">pH Minus</label>
                        </div>
                        <div class="checklist-item">
                            <input type="checkbox" id="chem-alkalinity" name="chemicals_used" value="alkalinity">
                            <label for="chem-alkalinity">Alkalinity Increaser</label>
                        </div>
                        <div class="checklist-item">
                            <input type="checkbox" id="chem-shock" name="chemicals_used" value="shock">
                            <label for="chem-shock">Bromine Shock</label>
                        </div>
                        <div class="checklist-item">
                            <input type="checkbox" id="chem-anti-foam" name="chemicals_used" value="anti-foam">
                            <label for="chem-anti-foam">Anti-Foam</label>
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="chemical-amounts">Chemical Amounts & Details:</label>
                    <textarea id="chemical-amounts" name="chemical_amounts" rows="3" placeholder="Record specific amounts and dosages (e.g., Bromine: 3 tablets, pH Plus: 25ml)"></textarea>
                </div>
                
                <div class="form-group">
                    <label for="chemical-notes">Chemical Treatment Notes:</label>
                    <textarea id="chemical-notes" name="chemical_notes" rows="3" placeholder="Record any specific treatments or observations..."></textarea>
                </div>
            </div>

            <div class="section">
                <h2>Issues & Maintenance Notes</h2>
                <div class="form-group">
                    <label for="issues-identified">Issues Identified:</label>
                    <textarea id="issues-identified" name="issues_identified" rows="4" placeholder="Document any equipment issues, water quality problems, or safety concerns..."></textarea>
                </div>
                
                <div class="form-row" style="margin-top: 20px;">
                    <div>
                        <label for="priority-level">Priority Level:</label>
                        <select id="priority-level" name="priority_level" onchange="updateFollowUpDate()">
                            <option value="low">Low - Routine</option>
                            <option value="medium">Medium - Schedule Soon</option>
                            <option value="high">High - Urgent</option>
                            <option value="critical">Critical - Immediate Action</option>
                        </select>
                    </div>
                    <div>
                        <label for="follow-up-date">Follow-up Required By:</label>
                        <input type="date" id="follow-up-date" name="follow_up_date">
                    </div>
                </div>

                <div class="form-group">
                    <label for="maintenance-photos">Upload Photos (Max 3 files, 10MB each):</label>
                    <input type="file" id="maintenance-photos" name="maintenance_photos" accept="image/*" multiple style="padding: 15px; border: 2px dashed var(--primary-orange);">
                    <small style="display: block; margin-top: 5px; color: var(--dark-gray);">
                        Accepted formats: JPG, PNG, HEIC. Files will be automatically compressed if needed.
                    </small>
                </div>
            </div>

            <!-- Success/Error Messages -->
            <div id="success-message" class="success-message">
                <strong>✅ Success!</strong> Your maintenance report has been submitted successfully. You will receive a confirmation email shortly.
            </div>
            
            <div id="error-message" class="error-message">
                <strong>❌ Error!</strong> <span id="error-text">There was a problem submitting your report. Please check all required fields and try again.</span>
            </div>

            <!-- Loading indicator -->
            <div id="loading" class="loading">
                <p>📤 Submitting your maintenance report...</p>
            </div>

            <div class="btn-container" style="text-align: center; margin: 30px 0;">
                <button type="button" class="btn" onclick="saveDocument()">💾 Save Locally</button>
                <button type="button" class="btn" onclick="exportPDF()">📄 Print Report</button>
                <button type="submit" class="btn btn-success" id="submit-btn">
                    📧 Submit Report
                </button>
            </div>

            <!-- Hidden fields for form processing -->
            <div class="hidden-fields">
                <input type="hidden" name="submission_time" id="submission-time">
                <input type="hidden" name="form_version" value="2.0">
                <input type="hidden" name="system_type" value="hot-tub-maintenance">
            </div>
        </form>

        <div class="emergency-contact">
            <h3>Emergency Contacts</h3>
            <p><strong>Emergency Services:</strong> 999 | <strong>Site Manager:</strong> [Enter Number] | <strong>Maintenance Team:</strong> [Enter Number]</p>
        </div>
    </div>

    <!-- SWP Floating Button -->
    <div class="swp-button" onclick="openSWPLibrary()">
        SWP
        <span class="swp-tooltip">Safe Working Procedures</span>
    </div>

    <script>
        // Hot tub data
        const hotTubData = {
            'HT-001': { location: 'Pool Deck', capacity: 1500, brand: 'Jacuzzi J-375' },
            'HT-002': { location: 'Cabin Area', capacity: 1200, brand: 'HotSpring Highlife' },
            'HT-003': { location: 'Spa Complex', capacity: 2000, brand: 'Caldera Niagara' },
            'HT-004': { location: 'Lodge Terrace', capacity: 1800, brand: 'Master Spas' },
            'HT-005': { location: 'Beach House', capacity: 1600, brand: 'Bullfrog Spas' }
        };

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            // Auto-set today's date
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('maintenance-date').value = today;
            document.getElementById('last-service').value = today;
            
            // Add form submission handler
            document.getElementById('maintenanceForm').addEventListener('submit', handleFormSubmission);
            
            // Add file upload validation
            const fileInput = document.getElementById('maintenance-photos');
            fileInput.addEventListener('change', validateFileUpload);
        });

        // Update hot tub specs when selected
        function updateHotTubSpecs() {
            const selectedId = document.getElementById('hottub-id').value;
            const capacityInput = document.getElementById('hottub-capacity');
            const infoDiv = document.getElementById('selected-hottub-info');
            const detailsDiv = document.getElementById('selected-hottub-details');
            
            if (selectedId && hotTubData[selectedId]) {
                const hotTub = hotTubData[selectedId];
                capacityInput.value = hotTub.capacity;
                
                detailsDiv.innerHTML = `
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px;">
                        <div><strong>ID:</strong> ${selectedId}</div>
                        <div><strong>Location:</strong> ${hotTub.location}</div>
                        <div><strong>Brand:</strong> ${hotTub.brand}</div>
                        <div><strong>Capacity:</strong> ${hotTub.capacity}L</div>
                    </div>
                `;
                
                infoDiv.style.display = 'block';
            } else {
                capacityInput.value = '';
                infoDiv.style.display = 'none';
            }
        }

        // Show maintenance tasks based on selection
        function showMaintenanceTasks() {
            const maintenanceType = document.getElementById('maintenance-type').value;
            const dailyTasks = document.getElementById('daily-tasks');
            const changeoverTasks = document.getElementById('changeover-tasks');
            
            dailyTasks.style.display = 'none';
            changeoverTasks.style.display = 'none';
            
            if (maintenanceType === 'daily') {
                dailyTasks.style.display = 'block';
            } else if (maintenanceType === 'changeover') {
                changeoverTasks.style.display = 'block';
            }
        }

        // Complete all daily tasks
        function completeAllDailyTasks() {
            const checkboxes = document.querySelectorAll('#daily-tasks input[type="checkbox"]');
            checkboxes.forEach(cb => cb.checked = true);
            
            // Fill in optimal water quality values
            document.getElementById('ph-level').value = (7.2 + Math.random() * 0.4).toFixed(1);
            document.getElementById('bromine-level').value = (3.0 + Math.random() * 2.0).toFixed(1);
            document.getElementById('temperature').value = (37.0 + Math.random() * 2.5).toFixed(1);
            document.getElementById('total-alkalinity').value = Math.floor(80 + Math.random() * 40);
            
            alert('✅ All daily tasks completed and optimal water quality values populated!');
        }

        // Update follow-up date based on priority
        function updateFollowUpDate() {
            const priority = document.getElementById('priority-level').value;
            const followUpInput = document.getElementById('follow-up-date');
            const today = new Date();
            
            let daysToAdd = 0;
            switch(priority) {
                case 'critical': daysToAdd = 0; break;
                case 'high': daysToAdd = 1; break;
                case 'medium': daysToAdd = 7; break;
                case 'low': daysToAdd = 30; break;
            }
            
            const followUpDate = new Date(today);
            followUpDate.setDate(today.getDate() + daysToAdd);
            followUpInput.value = followUpDate.toISOString().split('T')[0];
        }

        // Validate file upload
        function validateFileUpload(event) {
            const files = event.target.files;
            const maxFiles = 3;
            const maxSize = 10 * 1024 * 1024; // 10MB
            
            if (files.length > maxFiles) {
                alert(`Maximum ${maxFiles} files allowed. Please select fewer files.`);
                event.target.value = '';
                return;
            }
            
            for (let file of files) {
                if (file.size > maxSize) {
                    alert(`File "${file.name}" is too large. Maximum size is 10MB per file.`);
                    event.target.value = '';
                    return;
                }
            }
        }

        // Handle form submission
        function handleFormSubmission(event) {
            event.preventDefault();
            
            // Set submission timestamp
            document.getElementById('submission-time').value = new Date().toISOString();
            
            // Show loading state
            showLoading(true);
            hideMessages();
            
            // Validate required fields
            if (!validateForm()) {
                showLoading(false);
                showError('Please fill in all required fields before submitting.');
                return;
            }
            
            // Submit form using Formspree
            const form = event.target;
            const formData = new FormData(form);
            
            fetch(form.action, {
                method: 'POST',
                body: formData,
                headers: {
                    'Accept': 'application/json'
                }
            }).then(response => {
                showLoading(false);
                if (response.ok) {
                    showSuccess();
                    form.reset();
                    updateHotTubSpecs(); // Reset the hot tub display
                } else {
                    response.json().then(data => {
                        if (data.errors) {
                            showError('Form submission failed: ' + data.errors.map(error => error.message).join(', '));
                        } else {
                            showError('There was a problem submitting your form. Please try again.');
                        }
                    });
                }
            }).catch(error => {
                showLoading(false);
                showError('Network error. Please check your connection and try again.');
                console.error('Error:', error);
            });
        }

        // Form validation
        function validateForm() {
            const requiredFields = [
                'business_name',
                'maintenance_date', 
                'technician_name',
                'hottub_id',
                'maintenance_type'
            ];
            
            for (let fieldName of requiredFields) {
                const field = document.querySelector(`[name="${fieldName}"]`);
                if (!field || !field.value.trim()) {
                    field?.focus();
                    return false;
                }
            }
            return true;
        }

        // UI helper functions
        function showLoading(show) {
            const loading = document.getElementById('loading');
            const submitBtn = document.getElementById('submit-btn');
            
            if (show) {
                loading.classList.add('show');
                submitBtn.disabled = true;
                submitBtn.textContent = '📤 Submitting...';
            } else {
                loading.classList.remove('show');
                submitBtn.disabled = false;
                submitBtn.textContent = '📧 Submit Report';
            }
        }

        function showSuccess() {
            document.getElementById('success-message').classList.add('show');
            setTimeout(() => {
                document.getElementById('success-message').classList.remove('show');
            }, 5000);
        }

        function showError(message) {
            document.getElementById('error-text').textContent = message;
            document.getElementById('error-message').classList.add('show');
            setTimeout(() => {
                document.getElementById('error-message').classList.remove('show');
            }, 5000);
        }

        function hideMessages() {
            document.getElementById('success-message').classList.remove('show');
            document.getElementById('error-message').classList.remove('show');
        }

        // Save document locally
        function saveDocument() {
            const formData = new FormData(document.getElementById('maintenanceForm'));
            const data = {};
            for (let [key, value] of formData.entries()) {
                if (data[key]) {
                    if (Array.isArray(data[key])) {
                        data[key].push(value);
                    } else {
                        data[key] = [data[key], value];
                    }
                } else {
                    data[key] = value;
                }
            }
            
            const jsonData = JSON.stringify(data, null, 2);
            const blob = new Blob([jsonData], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `hottub-maintenance-${data.business_name || 'report'}-${new Date().toISOString().split('T')[0]}.json`;
            a.click();
            URL.revokeObjectURL(url);
            
            alert('✅ Document saved to your device!');
        }

        // Export PDF (print)
        function exportPDF() {
            window.print();
        }

        // SWP Library placeholder
        function openSWPLibrary() {
            alert('🔧 Safe Working Procedures Library\n\nThis would open your organization\'s SWP library with procedures for:\n\n• Hot Tub Maintenance\n• Chemical Handling\n• Water Testing\n• Emergency Procedures\n• PPE Requirements\n• Risk Assessments\n• Legionella Control\n\nPlease ensure all staff are trained on relevant procedures.');
        }

        // Close modal when clicking outside
        window.addEventListener('click', function(event) {
            if (event.target.classList.contains('modal')) {
                event.target.style.display = 'none';
            }
        });

        // Keyboard shortcuts
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                const modals = document.querySelectorAll('[style*="display: flex"]');
                modals.forEach(modal => modal.style.display = 'none');
            }
        });
    </script>
</body>
</html>